#!/usr/bin/python3
import socket
import sys

if len(sys.argv) != 3:	
	print("Usage: vrfy.py <username_file> <ip>")
	sys.exit(0)

# Create a Socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the Server
connect = s.connect((sys.argv[2], 25))

# Receive the banner
banner = s.recv(1024)

print(banner.decode('utf-8'))

f = open(sys.argv[1], "r")
for line in f:
    # VRFY a user
    query = ('VRFY ' + line)
    query_as_bytes = str.encode(query)
    s.sendall(query_as_bytes)
    result = s.recv(1024)
    print(result.decode('utf-8'))

# Close the socket
s.close()
